{
  "name": "Drupal-compose",
  "tagline": "Docker-based environment for Drupal",
  "body": "# Docker-based environment for Drupal\r\n\r\nUse this Docker compose file to spin up local environment for Drupal with a *native Docker app* on Linux, Mac OS X and Windows. \r\n\r\n* [Overview](#overview)\r\n* [Instructions](#instructions)\r\n* [Drush](#drush)\r\n* [Composer](#composer)\r\n* [Xdebug](#xdebug)\r\n* [Database](#database)\r\n* [Cache](#cache)\r\n* [Accessing containers](#accessing-containers)\r\n* [Logs](#logs)\r\n* [Updating](#updating)\r\n* [Status](#status)\r\n* [Troubleshooting](#troubleshooting)\r\n* [Going beyound local machine](#going-beyond-local-machine)\r\n\r\n## Overview\r\n\r\nThe Drupal bundle consist of the following containers:\r\n\r\n| Container | Service name | Image | \r\n| --------- | ------- | ----- |\r\n| Nginx   | web | <a href=\"https://hub.docker.com/r/wodby/drupal-nginx/\" target=\"_blank\">wodby/drupal-nginx</a> |\r\n| PHP 7, 5.6   | app | <a href=\"https://hub.docker.com/r/wodby/drupal-php/\" target=\"_blank\">wodby/drupal-php</a> |\r\n| MariaDB | db  |<a href=\"https://hub.docker.com/r/wodby/drupal-mariadb/\" target=\"_blank\">wodby/drupal-mariadb</a> |\r\n| Redis | cache  |<a href=\"https://hub.docker.com/_/redis/\" target=\"_blank\">redis:3.2-alpine</a> \r\n| Memcached | cache  |<a href=\"https://hub.docker.com/_/memcached/\" target=\"_blank\">memcached:1.4-alpine</a> |\r\n\r\nPHP, Nginx and MariaDB configs are optimized to be used with Drupal. We regularly update this bundle with performance improvements, bug fixes and newer version of Nginx/PHP/MariaDB.\r\n\r\n## Instructions \r\n\r\nSupported Drupal versions: 7 and 8\r\n\r\nSupported PHP versions: 7.0 and 5.6\r\n\r\n1\\. Install docker for <a href=\"https://docs.docker.com/engine/installation/\" target=\"_blank\">Linux</a>, <a href=\"https://docs.docker.com/engine/installation/mac\" target=\"_blank\">Mac OS X</a> or <a href=\"https://docs.docker.com/engine/installation/windows\" target=\"_blank\">Windows</a>. You need to install docker 1.12, not docker toolbox. \r\n\r\nFor Linux additionally install <a href=\"https://docs.docker.com/compose/install/\" target=\"_blank\">docker compose</a>\r\n\r\n2\\. Download <a href=\"https://raw.githubusercontent.com/Wodby/drupal-compose/master/docker-compose.yml\" target=\"_blank\">the compose file</a> from this repository\r\n\r\n3\\. Since containers <a href=\"https://docs.docker.com/engine/tutorials/dockervolumes/\" target=\"_blank\">do not have a permanent storage</a>, directories from the host machine (volumes) should be mounted: one with your Drupal project and another with database files. By default `docroot` and `mariadb` directories will be automatically created in the same directory as the compose file. \r\n\r\nFirst, let's edit the path to volume with your Drupal project for the PHP container. Find the following line in the downloaded `drupal-compose.yml` file\r\n```yml\r\n- ./docroot:/var/www/html\r\n```\r\n\r\nand replace it with your path:\r\n```yml\r\n- /path/to/my/drupal/docroot:/var/www/html\r\n```\r\n\r\nAdditionally, you can adjust path to the database files directory (`- ./mariadb:/var/lib/mysql`). \r\n\r\n**Linux only**: fix permissions for your files directory with:\r\n```bash\r\n$ sudo chgrp -R 82 sites/default/files\r\n$ sudo chmod -R 775 sites/default/files\r\n```\r\n\r\n4\\. Choose Drupal version by modifying the following environment variable (could be 7 or 8) in the compose file:\r\n```yml\r\nDRUPAL_VERSION: 8\r\n```\r\n\r\n5\\. Update database credentials in your settings.php file:\r\n```\r\ndatabase: drupal\r\nusername: drupal\r\npassword: drupal\r\nhost: db\r\n```\r\n\r\n6\\. If you want to import your database, uncomment the following line in the compose file:\r\n```yml\r\n#    - ./mariadb-init:/docker-entrypoint-initdb.d\r\n```\r\n\r\nCreate the volume directory `mariadb-init` in the same directory as the compose file and put there your SQL file(s). All SQL files will be automatically imported once MariaDB container has started.\r\n\r\n7\\. Now, let's run the compose file. It will download the images and run the containers:\r\n```bash\r\n$ docker-compose up -d\r\n```\r\n\r\n8\\. Make sure all containers are running by executing:\r\n\r\n```bash\r\n$ docker-compose ps\r\n```\r\n\r\n9\\. That's it! You drupal website should be up and running at http://localhost:8000. \r\n\r\n## Drush\r\n\r\nPHP container has installed drush, connect to the container to use drush.\r\n\r\n## Composer\r\n\r\nPHP container has installed composer, connect to the container to use composer.\r\n\r\n## Xdebug\r\n\r\nIf you want to debug your project, uncomment the following line in the compose file:\r\n\r\n```yml\r\n#    XDEBUG_CONFIG: xdebug.remote_autostart=1\r\n```\r\n\r\nSee the <a href=\"https://github.com/Wodby/drupal-php/issues/1\" target=\"_blank\">known issue</a> with Xdebug in Mac OS.\r\n\r\n## Database\r\n\r\n### Making a dump\r\n\r\nDump all databases:\r\n\r\n```bash\r\ndocker-compose exec db sh -c 'exec mysqldump --all-databases -uroot -p\"root-password\"' > databases.sql\r\n```\r\n\r\nDump a specific one:\r\n\r\n```bash\r\ndocker-compose exec db sh -c 'exec mysqldump -uroot -p\"root-password\" my-db' > my-db.sql\r\n```\r\n\r\n## Cache\r\n\r\n### Redis\r\n\r\nIf you want to use redis, install <a href=\"https://www.drupal.org/project/redis\" target=\"_blank\">redis module</a> in your project and add following lines to the settings.php file:\r\n\r\n```php\r\n$conf['redis_client_host'] = 'redis';\r\n$conf['redis_client_interface'] = 'PhpRedis';\r\n$conf['lock_inc'] = $contrib_path . '/redis/redis.lock.inc';\r\n$conf['path_inc'] = $contrib_path . '/redis/redis.path.inc';\r\n$conf['cache_backends'][] = 'sites/all/modules/redis/redis.autoload.inc';\r\n$conf['cache_default_class'] = 'Redis_Cache';\r\n$conf['cache_class_cache_form'] = 'DrupalDatabaseCache';\r\n```\r\n\r\n### Memcached\r\n\r\nIf you want to use redis, install <a href=\"https://www.drupal.org/project/memcache\" target=\"_blank\">memcache module</a> in your project and add following lines to the settings.php file:\r\n\r\n```php\r\n$conf['cache_backends'][] = 'sites/all/modules/memcache/memcache.inc';\r\n$conf['lock_inc'] = 'sites/all/modules/memcache/memcache-lock.inc';\r\n$conf['memcache_stampede_protection'] = TRUE;\r\n$conf['cache_default_class'] = 'MemCacheDrupal';\r\n$conf['cache_class_cache_form'] = 'DrupalDatabaseCache';\r\n$conf['memcache_servers'] = array('cache:11211' => 'default');\r\n```\r\n\r\nAlso, don't forget to uncomment th following line in the compose file:\r\n\r\n```yml\r\n#  image: memcached:1.4-alpine\r\n```\r\n\r\nAnd comment the following one:\r\n\r\n```yml\r\n  image: redis:3.2-alpine\r\n```\r\n\r\n## Accessing containers\r\n\r\nYou can connect to any container by executing the following command (example for PHP container):\r\n```bash\r\n$ docker-compose exec app sh\r\n```\r\n\r\nReplace `app` with the name of your service: `db` (mariadb) or `web` (nginx).\r\n\r\n## Logs\r\n\r\nTo get logs from a container simply run (skip the last param to get logs form all the containers):\r\n```\r\n$ docker-compose logs [service]\r\n```\r\n\r\nExample: real-time logs of php container:\r\n```\r\n$ docker-compose logs -f app\r\n```\r\n\r\n## Updating\r\n\r\nWe update containers from time to time, to get the lastest changes simply run again:\r\n```\r\n$ docker-compose up -d\r\n```\r\n\r\n## Status\r\n\r\nWe're actively working on this instructions and containers. More options will be added soon. If you have a feature request or found a bug please sumbit an issue.\r\n\r\n## Troubleshooting\r\n\r\nIn case you have any problems submit an issue or contact us at hello [at] wodby.com.\r\n\r\n## Going beyond local machine\r\n\r\nCheck out <a href=\"https://wodby.com\" target=\"_blank\">Wodby</a> if you need optimized consistent docker-based environment for Drupal on your dev/staging or production servers. ",
  "note": "Don't delete this file! It's used internally to help with page regeneration."
}